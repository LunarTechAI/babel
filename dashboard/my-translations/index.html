<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>My Translations - Handex</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#8A2BE2",
                        "background-dark": "#12121B",
                    },
                    fontFamily: { "display": ["Inter", "sans-serif"] },
                },
            },
        }
    </script>
    <link rel="stylesheet" href="/static/public/styles.css">
    <style>
        /* Keep only specific styles not in global CSS if any, otherwise empty or minimal */
    </style>
</head>

<body class="bg-background-dark font-display text-white">
    <div class="relative flex min-h-screen w-full flex-col">
        <!-- Header -->
        <header class="w-full px-4 sm:px-6 lg:px-8 py-6 border-b border-white/5 bg-background-dark/80 backdrop-blur-xl">
            <div class="mx-auto max-w-7xl w-full flex items-center">
                <a href="/static/index.html"><img src="/static/public/handex-logo.png" alt="HANDEX" class="h-9 w-auto" /></a>
                <div class="ml-auto flex items-center gap-6">
                    <nav class="flex items-center gap-6">
                        <a href="/static/index.html"
                            class="text-sm font-medium text-white/80 hover:text-white">Dashboard</a>
                        <a href="/static/my-translations/index.html" class="text-sm font-medium text-primary">My
                            Translations</a>
                    </nav>
                    <a href="/static/account/index.html"
                        class="flex h-10 w-10 items-center justify-center rounded-lg bg-primary text-white">
                        <span class="material-symbols-outlined text-xl">account_circle</span>
                    </a>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1 px-4 sm:px-6 lg:px-8 py-10">
            <div class="mx-auto max-w-7xl">
                <div class="flex items-center justify-between mb-8">
                    <h1 class="text-3xl font-bold text-white">My Translations</h1>
                    <a href="/static/upload-page/index.html"
                        class="flex items-center gap-2 px-4 py-2 rounded-lg bg-primary hover:bg-primary/90 text-white text-sm font-medium">
                        <span class="material-symbols-outlined">add</span>
                        <span>New Translation</span>
                    </a>
                </div>

                <div id="translations-list" class="space-y-4">
                    <!-- Loading state -->
                    <div class="text-center py-12">
                        <div
                            class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary">
                        </div>
                        <p class="mt-4 text-white/70">Loading translations...</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        async function loadTranslations() {
            try {
                const response = await fetch('http://localhost:8000/api/translations');
                const data = await response.json();

                const container = document.getElementById('translations-list');

                if (!data.translations || data.translations.length === 0) {
                    container.innerHTML = `
            <div class="text-center py-12">
              <span class="material-symbols-outlined text-white/30 text-6xl">folder_off</span>
              <p class="mt-4 text-white/70">No translations yet</p>
              <a href="/static/upload-page/index.html" class="mt-4 inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-primary hover:bg-primary/90 text-white text-sm font-medium">
                <span class="material-symbols-outlined">add</span>
                <span>Start Your First Translation</span>
              </a>
            </div>
          `;
                    return;
                }

                // Display translations
                container.innerHTML = data.translations.map(job => {
                    const statusColor = job.status === 'completed' ? 'green' : job.status === 'failed' ? 'red' : 'yellow';
                    const statusText = job.status === 'completed' ? 'Complete' : job.status === 'failed' ? 'Failed' : 'Processing';

                    return `
            <div class="bg-white/5 border border-white/10 rounded-lg p-6 hover:bg-white/10 transition-colors">
              <div class="flex items-start justify-between">
                <div class="flex-1">
                  <h3 class="text-lg font-semibold text-white">${job.original_filename || 'Document'}</h3>
                  <div class="mt-2 flex items-center gap-4 text-sm text-white/60">
                    <span>Target: ${job.target_language?.toUpperCase() || 'Unknown'}</span>
                    <span>â€¢</span>
                    <span>${new Date(job.created_at).toLocaleString()}</span>
                  </div>
                </div>
                <div class="flex items-center gap-2">
                  <span class="px-3 py-1 rounded-full text-xs font-medium bg-${statusColor}-500/20 text-${statusColor}-400">
                    ${statusText}
                  </span>
                  ${job.status === 'completed' && job.translated_file ? `
                    <a href="http://localhost:8000/api/download/${job.translated_file}" class="p-2 rounded-lg bg-primary hover:bg-primary/90 text-white">
                      <span class="material-symbols-outlined text-sm">download</span>
                    </a>
                    <button onclick="window.open('/static/viewer/index.html?file=${job.translated_file}', '_blank')" class="p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white">
                      <span class="material-symbols-outlined text-sm">visibility</span>
                    </button>
                  ` : ''}
                </div>
              </div>
            </div>
          `;
                }).join('');

            } catch (error) {
                console.error('Error loading translations:', error);
                document.getElementById('translations-list').innerHTML = `
          <div class="text-center py-12">
            <p class="text-red-400">Error loading translations</p>
            <p class="mt-2 text-white/60 text-sm">${error.message}</p>
          </div>
        `;
            }
        }

        // Load translations on page load
        loadTranslations();

        // Refresh every 5 seconds if there are processing jobs
        setInterval(loadTranslations, 5000);
    </script>
</body>

</html>