<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>My Translations - Handex</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Inter+Tight:wght@700;900&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#9333EA",
                        "primary-bright": "#A855F7",
                        "primary-dark": "#7E22CE",
                        "accent-cyan": "#06B6D4",
                        "accent-pink": "#EC4899",
                        "background-dark": "#0A0118",
                        "background-darker": "#050008",
                        "surface": "#120829"
                    },
                    fontFamily: {
                        "sans": ["Inter", "sans-serif"],
                        "display": ["Inter Tight", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "2xl": "1rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <link rel="stylesheet" href="../../public/styles.css">
</head>

<body
    class="premium-bg bg-[#0A0118] font-sans text-slate-300 min-h-screen overflow-x-hidden selection:bg-primary/30 selection:text-white">
    <!-- Ambient Glows -->
    <div class="fixed inset-0 z-[-1] overflow-hidden pointer-events-none">
        <div class="glow-purple w-[500px] h-[500px] top-[-100px] left-[-100px]"></div>
    </div>

    <div class="relative flex min-h-screen w-full flex-col">
        <!-- Top Header -->
        <header class="sticky top-0 z-50 w-full border-b border-white/5 bg-[#0A0118]/80 backdrop-blur-xl">
            <div class="mx-auto flex h-20 max-w-7xl items-center justify-between px-4 sm:px-6 lg:px-8">
                <!-- Logo -->
                <div class="flex items-center gap-4">
                    <span class="font-display font-bold text-xl text-white tracking-tight">BABEL</span>
                </div>

                <!-- Desktop Nav -->
                <nav class="hidden md:flex items-center gap-8">
                    <a href="/static/index.html"
                        class="text-sm font-medium text-slate-400 hover:text-white transition-colors">Dashboard</a>
                    <a href="/static/my-translations/index.html"
                        class="text-sm font-medium text-white transition-colors">My Translations</a>
                    <a href="/static/upload-page/index.html"
                        class="text-sm font-medium text-slate-400 hover:text-white transition-colors">Upload New</a>
                </nav>

                <!-- Right Actions -->
                <div class="flex items-center gap-4">
                    <button class="text-slate-400 hover:text-white transition-colors">
                        <span class="material-symbols-outlined">notifications</span>
                    </button>
                    <a href="/static/account/index.html"
                        class="flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1.5 text-sm font-medium text-white hover:bg-white/10 transition-colors">
                        <span class="material-symbols-outlined text-lg">account_circle</span>
                        <span class="hidden sm:inline">Account</span>
                    </a>
                    <!-- Mobile Menu Button -->
                    <button id="mobile-menu-button" class="md:hidden text-white">
                        <span class="material-symbols-outlined">menu</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Mobile Menu Overlay -->
        <div id="mobile-menu"
            class="fixed inset-0 z-40 bg-[#0A0118]/95 backdrop-blur-xl transform translate-x-full transition-transform duration-300 md:hidden pt-24 px-6">
            <nav class="flex flex-col gap-4">
                <a href="/static/index.html"
                    class="text-lg font-medium text-white py-2 border-b border-white/10">Dashboard</a>
                <a href="/static/my-translations/index.html"
                    class="text-lg font-medium text-slate-300 py-2 border-b border-white/10">My Translations</a>
                <a href="/static/upload-page/index.html"
                    class="text-lg font-medium text-slate-300 py-2 border-b border-white/10">Upload New</a>
                <a href="/static/account/index.html"
                    class="text-lg font-medium text-slate-300 py-2 border-b border-white/10">Settings</a>
            </nav>
        </div>

        <!-- Main Content -->
        <main class="flex-1 w-full p-4 sm:p-8 pt-12 sm:pt-32 relative z-10">
            <div class="mx-auto max-w-7xl">
                <div class="flex items-center justify-between mb-8">
                    <h1 class="text-3xl font-display font-bold text-white text-glow-purple">My Translations</h1>
                    <a href="/static/upload-page/index.html"
                        class="flex items-center gap-2 px-4 py-2 rounded-lg bg-primary-purple hover:bg-primary-purple-bright text-white text-sm font-medium transition-all hover-lift shadow-[0_0_20px_rgba(168,85,247,0.4)]">
                        <span class="material-symbols-outlined">add</span>
                        <span>New Translation</span>
                    </a>
                </div>

                <div id="translations-list" class="space-y-4">
                    <!-- Loading state -->
                    <div class="text-center py-12">
                        <div
                            class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-purple shadow-[0_0_15px_rgba(168,85,247,0.5)]">
                        </div>
                        <p class="mt-4 text-white/70">Loading translations...</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Mobile Menu Toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');

        if (mobileMenuButton && mobileMenu) {
            mobileMenuButton.addEventListener('click', () => {
                const isClosed = mobileMenu.classList.contains('translate-x-full');
                if (isClosed) {
                    mobileMenu.classList.remove('translate-x-full');
                } else {
                    mobileMenu.classList.add('translate-x-full');
                }
            });
        }

        async function loadTranslations() {
            try {
                const response = await fetch('http://localhost:8000/api/translations');
                const data = await response.json();

                const container = document.getElementById('translations-list');

                if (!data.translations || data.translations.length === 0) {
                    container.innerHTML = `
            <div class="glass-panel p-12 text-center">
              <span class="material-symbols-outlined text-white/30 text-6xl mb-4">folder_off</span>
              <p class="text-white/70 text-lg mb-6">No translations yet</p>
              <a href="/static/upload-page/index.html" class="inline-flex items-center gap-2 px-6 py-3 rounded-lg bg-primary-purple hover:bg-primary-purple-bright text-white text-sm font-medium transition-all hover-lift shadow-[0_0_20px_rgba(168,85,247,0.4)]">
                <span class="material-symbols-outlined">add</span>
                <span>Start Your First Translation</span>
              </a>
            </div>
          `;
                    return;
                }

                // Display translations
                container.innerHTML = data.translations.map((job, index) => {
                    const statusColor = job.status === 'completed' ? 'green' : job.status === 'failed' ? 'red' : 'yellow';
                    const statusText = job.status === 'completed' ? 'Complete' : job.status === 'failed' ? 'Failed' : 'Processing';

                    // Badge styling based on status
                    let badgeClass = '';
                    if (job.status === 'completed') {
                        badgeClass = 'bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 shadow-[0_0_10px_rgba(16,185,129,0.2)]';
                    } else if (job.status === 'failed') {
                        badgeClass = 'bg-red-500/10 text-red-400 border border-red-500/20 shadow-[0_0_10px_rgba(239,68,68,0.2)]';
                    } else {
                        badgeClass = 'bg-amber-500/10 text-amber-400 border border-amber-500/20 shadow-[0_0_10px_rgba(245,158,11,0.2)] animate-pulse';
                    }

                    return `
            <div class="glass-panel p-6 hover-elegant animate-fade-in-up" style="animation-delay: ${index * 100}ms">
              <div class="flex items-start justify-between">
                <div class="flex-1">
                  <div class="flex items-center gap-3 mb-2">
                    <div class="p-2 rounded-lg bg-white/5 border border-white/10">
                      <span class="material-symbols-outlined text-primary-purple-bright">description</span>
                    </div>
                    <h3 class="text-lg font-semibold text-white">${job.original_filename || 'Document'}</h3>
                  </div>
                  <div class="flex items-center gap-4 text-sm text-white/50 ml-12">
                    <span class="flex items-center gap-1"><span class="material-symbols-outlined text-base">translate</span> Target: ${job.target_language?.toUpperCase() || 'Unknown'}</span>
                    <span>â€¢</span>
                    <span class="flex items-center gap-1"><span class="material-symbols-outlined text-base">schedule</span> ${new Date(job.created_at).toLocaleString()}</span>
                  </div>
                </div>
                <div class="flex items-center gap-3">
                  <span class="px-3 py-1 rounded-full text-xs font-medium ${badgeClass} flex items-center gap-1">
                    ${job.status === 'completed' ? '<span class="material-symbols-outlined text-sm">check_circle</span>' : ''}
                    ${job.status === 'failed' ? '<span class="material-symbols-outlined text-sm">error</span>' : ''}
                    ${job.status !== 'completed' && job.status !== 'failed' ? '<span class="material-symbols-outlined text-sm animate-spin">sync</span>' : ''}
                    ${statusText}
                  </span>
                  ${job.status === 'completed' && job.translated_file ? `
                    <a href="http://localhost:8000/api/download/${job.translated_file}" class="p-2 rounded-lg bg-primary-purple/10 hover:bg-primary-purple/20 text-primary-purple-bright border border-primary-purple/20 transition-colors hover-lift" title="Download">
                      <span class="material-symbols-outlined">download</span>
                    </a>
                    <button onclick="window.open('/static/viewer/index.html?file=${job.translated_file}', '_blank')" class="p-2 rounded-lg bg-white/5 hover:bg-white/10 text-white border border-white/10 transition-colors hover-lift" title="View">
                      <span class="material-symbols-outlined">visibility</span>
                    </button>
                  ` : ''}
                </div>
              </div>
            </div>
          `;
                }).join('');

            } catch (error) {
                console.error('Error loading translations:', error);
                document.getElementById('translations-list').innerHTML = `
          <div class="glass-panel p-12 text-center border-red-500/30">
            <span class="material-symbols-outlined text-red-400 text-5xl mb-4">error_outline</span>
            <p class="text-red-400 font-medium text-lg">Error loading translations</p>
            <p class="mt-2 text-white/60 text-sm">${error.message}</p>
            <button onclick="loadTranslations()" class="mt-6 px-4 py-2 rounded-lg bg-white/5 hover:bg-white/10 text-white text-sm font-medium transition-colors border border-white/10">
              Try Again
            </button>
          </div>
        `;
            }
        }

        // Load translations on page load
        loadTranslations();

        // Refresh every 5 seconds if there are processing jobs
        setInterval(loadTranslations, 5000);
    </script>
</body>

</html>